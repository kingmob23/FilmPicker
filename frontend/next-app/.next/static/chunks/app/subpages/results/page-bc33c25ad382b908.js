(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[215],{8141:function(n,e,t){Promise.resolve().then(t.bind(t,9862))},5360:function(n,e,t){"use strict";var r=t(8646),i=t(7437),o=t(2265),c=t(9318);function l(){let n=(0,r._)(["\n  padding: 20px;\n  text-align: center;\n  background: #282c34;\n  color: white;\n  margin-bottom: 20px;\n"]);return l=function(){return n},n}let u=o.memo(()=>(0,i.jsx)(s,{children:(0,i.jsx)("h1",{children:"Film Picker"})}));u.displayName="Header",e.Z=u;let s=c.ZP.header(l())},9504:function(n,e,t){"use strict";t.d(e,{UsernamesProvider:function(){return c},X:function(){return o}});var r=t(7437),i=t(2265);let o=(0,i.createContext)(void 0),c=n=>{let{children:e}=n,[t,c]=(0,i.useState)([]);return(0,r.jsx)(o.Provider,{value:{usernames:t,setUsernames:c},children:e})}},9862:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return I}});var r=t(8646),i=t(7437),o=t(2265),c=t(9318),l=t(5360),u=t(6463),s=t(9504);function a(){let n=(0,r._)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  padding: 20px;\n"]);return a=function(){return n},n}function d(){let n=(0,r._)(["\n  list-style: none;\n  padding: 0;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n"]);return d=function(){return n},n}function f(){let n=(0,r._)(["\n  margin: 10px 0;\n  padding: 10px;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  width: 60%;\n  max-width: 400px;\n  text-align: center;\n  background-color: #f9f9f9;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n\n  &:hover {\n    background-color: #e9e9e9;\n  }\n"]);return f=function(){return n},n}function p(){let n=(0,r._)(["\n  text-decoration: ",";\n  cursor: pointer;\n  flex-grow: 1;\n"]);return p=function(){return n},n}function h(){let n=(0,r._)(["\n  margin-left: 10px;\n  padding: 5px 10px;\n  border: none;\n  background-color: ",";\n  color: #333;\n  border-radius: 4px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n\n  &:hover {\n    background-color: #c0c0c0;\n  }\n"]);return h=function(){return n},n}function x(){let n=(0,r._)(["\n  margin-top: 20px;\n  font-weight: bold;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n"]);return x=function(){return n},n}function m(){let n=(0,r._)(["\n  visibility: hidden;\n  width: 330px;\n  background-color: black;\n  color: #fff;\n  text-align: center;\n  border-radius: 6px;\n  padding: 5px 0;\n  position: absolute;\n  z-index: 1;\n  bottom: 125%;\n  left: 50%;\n  margin-left: -60px;\n  opacity: 0;\n  transition: opacity 0.3s;\n\n  &::after {\n    content: '';\n    position: absolute;\n    top: 100%;\n    left: 50%;\n    margin-left: -5px;\n    border-width: 5px;\n    border-style: solid;\n    border-color: black transparent transparent transparent;\n  }\n"]);return m=function(){return n},n}function g(){let n=(0,r._)(["\n  position: relative;\n  display: inline-block;\n\n  &:hover "," {\n    visibility: visible;\n    opacity: 1;\n  }\n"]);return g=function(){return n},n}function b(){let n=(0,r._)(["\n  margin: 10px;\n  padding: 10px 20px;\n  font-size: 16px;\n  cursor: pointer;\n"]);return b=function(){return n},n}var v=n=>{let{films:e,usernames:t}=n,[r,c]=(0,o.useState)(e),[l,u]=(0,o.useState)(null),[s,a]=(0,o.useState)(!1),[d,f]=(0,o.useState)(!1);(0,o.useEffect)(()=>{c(e)},[e]);let p=n=>{1!==r.length&&c(e=>e.includes(n)?e.filter(e=>e!==n):[...e,n])},h=n=>{navigator.clipboard.writeText(n),u(n),setTimeout(()=>u(null),1e3)},x=async()=>{if(1===r.length){a(!0);try{if(!(await fetch("/api/watchlist/remove",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({film:r[0],usernames:t})})).ok){console.error("Failed to remove the film");return}f(!0)}catch(n){console.error("An error occurred while removing the film",n)}finally{a(!1)}}};return(0,i.jsxs)(y,{children:[(0,i.jsx)(w,{children:r.map((n,e)=>(0,i.jsxs)(j,{children:[(0,i.jsx)(P,{onClick:()=>p(n),$crossedOut:r.length>1&&!r.includes(n),children:n}),(0,i.jsx)(k,{onClick:()=>h(n),$isCopied:l===n,children:l===n?"Copied":"Copy"})]},e))}),1===r.length&&(0,i.jsxs)(_,{children:["You should watch: ".concat(r[0]),(0,i.jsxs)(S,{children:[(0,i.jsx)(C,{onClick:x,disabled:s||d,children:d?"You sworn to watch it!":"We Will Watch It!"}),!d&&(0,i.jsx)(Z,{children:"This movie will be removed from our stored copy of watchlist of every participant, so you don't need to update next time."})]})]})]})};let y=c.ZP.div(a()),w=c.ZP.ul(d()),j=c.ZP.li(f()),P=c.ZP.span(p(),n=>{let{$crossedOut:e}=n;return e?"line-through":"none"}),k=c.ZP.button(h(),n=>{let{$isCopied:e}=n;return e?"#a0a0a0":"#dcdcdc"}),_=c.ZP.div(x()),Z=c.ZP.span(m()),S=c.ZP.div(g(),Z),C=c.ZP.button(b());function N(){let n=(0,r._)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100vh;\n  padding: 20px;\n"]);return N=function(){return n},n}function O(){let n=(0,r._)(["\n  margin-top: 20px;\n  margin-bottom: 20px;\n"]);return O=function(){return n},n}function E(){let n=(0,r._)(["\n  margin-top: 20px;\n  text-align: right;\n  width: 60%;\n  max-width: 400px;\n  font-weight: bold;\n"]);return E=function(){return n},n}var T=()=>{let n=(0,u.useSearchParams)(),[e,t]=(0,o.useState)([]),[r,c]=(0,o.useState)(0),{usernames:l=[]}=(0,o.useContext)(s.X)||{};return(0,o.useEffect)(()=>{let e=n.get("intersection"),r=n.get("intersectionLen");e&&t(JSON.parse(e)),r&&c(parseInt(r,10))},[n]),(0,i.jsxs)(W,{children:[(0,i.jsx)(R,{children:"What to watch?"}),(0,i.jsx)(v,{films:e,usernames:l}),(0,i.jsxs)(z,{children:["btw you have ",r," films in common"]})]})};let W=c.ZP.div(N()),R=c.ZP.h2(O()),z=c.ZP.p(E());function F(){let n=(0,r._)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 100%;\n  height: 100vh;\n  padding: 20px;\n"]);return F=function(){return n},n}var I=()=>(0,i.jsxs)(J,{children:[(0,i.jsx)(l.Z,{}),(0,i.jsx)(o.Suspense,{fallback:(0,i.jsx)("div",{children:"Loading..."}),children:(0,i.jsx)(T,{})})]});let J=c.ZP.div(F())},6463:function(n,e,t){"use strict";var r=t(1169);t.o(r,"useRouter")&&t.d(e,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(e,{useSearchParams:function(){return r.useSearchParams}})}},function(n){n.O(0,[268,971,23,744],function(){return n(n.s=8141)}),_N_E=n.O()}]);